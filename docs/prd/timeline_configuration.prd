# PRD - Configuration Dynamique du Calendrier de Projet

## ğŸ“‹ MÃ©tadonnÃ©es du Document

- **Titre** : Configuration Dynamique des Dates du Timeline du Projet
- **Version** : 1.0
- **Date de crÃ©ation** : 10 novembre 2025
- **Auteur** : GitHub Copilot
- **Statut** : Proposition - En attente d'approbation
- **PrioritÃ©** : Haute
- **Effort estimÃ©** : 2-3 heures

---

## ğŸ¯ Objectif

Rendre les dates du calendrier de projet (timeline) configurables dynamiquement via un fichier JSON et une interface d'administration, permettant ainsi d'adapter facilement les dates pour diffÃ©rents groupes d'Ã©tudiants sans modifier le code HTML.

---

## ğŸ“Š Contexte et ProblÃ©matique

### Situation Actuelle

La page `project_timeline.html` contient **8 cartes de sprint** avec des dates codÃ©es en dur :

| Sprint | Date actuelle (codÃ©e en dur) | Ã‰lÃ©ment HTML |
|--------|------------------------------|--------------|
| Sprint 1 | Semaine du 3 novembre | `<div class="sprint-date">` |
| Sprint 2 | Semaine du 10 novembre | `<div class="sprint-date">` |
| Sprint 3 | Semaine du 17 novembre | `<div class="sprint-date">` |
| Sprint 4 | Semaine du 24 novembre | `<div class="sprint-date">` |
| Sprint 5 | Semaine du 1er dÃ©cembre | `<div class="sprint-date">` |
| Sprint 6 | Semaine du 8 dÃ©cembre au 23 janvier | `<div class="sprint-date">` |
| Sprint 7 | Semaine du 26 janvier | `<div class="sprint-date">` |
| PrÃ©sentation | Semaine du 2 fÃ©vrier | `<div class="sprint-date">` |

### ProblÃ¨me IdentifiÃ©

1. **Modification manuelle** : Chaque changement de dates nÃ©cessite l'Ã©dition directe du fichier HTML
2. **Groupes multiples** : Les dates varient selon les groupes d'Ã©tudiants, mais un seul fichier HTML existe
3. **Maintenance complexe** : Risque d'erreurs lors des modifications rÃ©pÃ©titives
4. **Pas d'interface** : Aucun moyen simple pour l'administrateur de mettre Ã  jour les dates

### Utilisateurs ImpactÃ©s

- **Administrateur/Enseignant** : Doit pouvoir configurer les dates facilement
- **Ã‰tudiants** : Visualisent le calendrier adaptÃ© Ã  leur groupe

---

## ğŸ’¡ Solution ProposÃ©e

### Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Interface Admin (admin-timeline.html)          â”‚
â”‚  - Formulaire de configuration des 8 dates      â”‚
â”‚  - Sauvegarde via GitHub API                    â”‚
â”‚  - Export JSON manuel                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ Ã‰crit/Lit
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Fichier JSON (config/timeline.json)            â”‚
â”‚  {                                               â”‚
â”‚    "sprints": [                                  â”‚
â”‚      { "id": 1, "label": "...", "date": "..." },â”‚
â”‚      ...                                         â”‚
â”‚    ]                                             â”‚
â”‚  }                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ Lit
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Page Timeline (project_timeline.html)          â”‚
â”‚  - JavaScript charge timeline.json              â”‚
â”‚  - Injecte dynamiquement les dates              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Composants

#### 1. Fichier de Configuration : `config/timeline.json`

```json
{
  "sprints": [
    {
      "id": 1,
      "label": "Sprint 1",
      "date": "3 novembre"
    },
    {
      "id": 2,
      "label": "Sprint 2",
      "date": "10 novembre"
    },
    {
      "id": 3,
      "label": "Sprint 3",
      "date": "17 novembre"
    },
    {
      "id": 4,
      "label": "Sprint 4",
      "date": "24 novembre"
    },
    {
      "id": 5,
      "label": "Sprint 5",
      "date": "1er dÃ©cembre"
    },
    {
      "id": 6,
      "label": "Sprint 6",
      "date": "8 dÃ©cembre au 23 janvier"
    },
    {
      "id": 7,
      "label": "Sprint 7",
      "date": "26 janvier"
    },
    {
      "id": 8,
      "label": "PrÃ©senter les rÃ©sultats",
      "date": "2 fÃ©vrier"
    }
  ]
}
```

**SchÃ©ma du modÃ¨le de donnÃ©es** :

| Champ | Type | Description | Exemple |
|-------|------|-------------|---------|
| `id` | number | Identifiant unique du sprint | `1` |
| `label` | string | LibellÃ© du sprint | `"Sprint 1"` |
| `date` | string | Date formatÃ©e Ã  afficher (format libre) | `"3 novembre"` ou `"8 dÃ©cembre au 23 janvier"` |

**Note** : Le format de date est libre (pas de contrainte ISO) pour permettre des plages comme "8 dÃ©cembre au 23 janvier".

#### 2. Page d'Administration : `pages/admin/admin-timeline.html`

**FonctionnalitÃ©s** :
- âœ… Formulaire avec 8 champs texte pour les dates
- âœ… Chargement automatique des dates actuelles depuis `timeline.json`
- âœ… Validation des champs (non vides)
- âœ… PrÃ©visualisation avant sauvegarde
- âœ… Sauvegarde via GitHub API (pattern identique Ã  `admin-announcements.html`)
- âœ… Export manuel JSON en fallback
- âœ… Protection admin (auth-guard + admin-guard)
- âœ… Design cohÃ©rent avec les autres pages admin

**Structure du formulaire** :

```html
<form id="timeline-form">
  <div class="form-group">
    <label for="sprint1">Sprint 1</label>
    <input type="text" id="sprint1" placeholder="Ex: 3 novembre" required>
  </div>
  <!-- RÃ©pÃ©tÃ© pour les 8 sprints -->
</form>
```

#### 3. Modification de `project_timeline.html`

**Changements** :
- âœ… Ajouter un attribut `data-sprint-id` sur chaque `<div class="sprint-date">`
- âœ… Script JavaScript pour charger `timeline.json`
- âœ… Injection dynamique des dates via DOM manipulation
- âœ… Fallback sur dates en dur si le JSON ne charge pas

**Avant** :
```html
<div class="sprint-date">Semaine du 3 novembre</div>
```

**AprÃ¨s** :
```html
<div class="sprint-date" data-sprint-id="1">Semaine du 3 novembre</div>
<!-- La date "3 novembre" sera remplacÃ©e dynamiquement -->
```

**Script d'injection** :
```javascript
(async function loadTimelineDates() {
  try {
    const response = await fetch('../../config/timeline.json');
    const data = await response.json();
    
    data.sprints.forEach(sprint => {
      const el = document.querySelector(`[data-sprint-id="${sprint.id}"]`);
      if (el) {
        el.textContent = `Semaine du ${sprint.date}`;
      }
    });
  } catch (e) {
    console.warn('Impossible de charger timeline.json, dates par dÃ©faut conservÃ©es');
  }
})();
```

---

## ğŸ”§ SpÃ©cifications Techniques

### Fichier JSON

**Emplacement** : `config/timeline.json`

**Format** :
```json
{
  "sprints": [
    {
      "id": number,        // 1-8
      "label": string,     // "Sprint 1", "Sprint 2", etc.
      "date": string       // Format libre, ex: "3 novembre" ou "8 dÃ©cembre au 23 janvier"
    }
  ]
}
```

**Validation** :
- âœ… `id` : Nombre entre 1 et 8, unique
- âœ… `label` : ChaÃ®ne non vide
- âœ… `date` : ChaÃ®ne non vide, pas de contrainte de format (libertÃ© totale)

### Page Admin (`admin-timeline.html`)

**Emplacement** : `pages/admin/admin-timeline.html`

**Scripts requis** :
```html
<script src="../../assets/js/auth-guard.js"></script>
<script src="../../assets/js/admin-guard.js"></script>
```

**Structure HTML** :
```html
<div class="container">
  <header>
    <h1><i class="fas fa-calendar-alt"></i> Gestion du Calendrier</h1>
    <a href="../main/menu.html" class="back-btn">Retour</a>
  </header>

  <!-- Configuration GitHub (identique Ã  admin-announcements) -->
  <div id="github-config" class="github-config">
    <!-- ... -->
  </div>

  <!-- Onglets -->
  <div class="tabs">
    <button class="tab-btn active" data-tab="edit">Modifier les Dates</button>
  </div>

  <!-- Contenu -->
  <div id="edit-tab" class="tab-content active">
    <form id="timeline-form">
      <div class="form-row">
        <label>Sprint 1</label>
        <input type="text" id="sprint1" placeholder="Ex: 3 novembre" required>
      </div>
      <!-- RÃ©pÃ©tÃ© 8 fois -->
    </form>
    <div class="button-group">
      <button id="save-github-btn">Sauvegarder (GitHub)</button>
      <button id="export-btn">Exporter JSON</button>
    </div>
  </div>
</div>
```

**Fonctions JavaScript** :
- `loadTimeline()` : Charge `timeline.json` et remplit le formulaire
- `saveToGitHub()` : Sauvegarde via GitHub API (pattern identique Ã  admin-announcements)
- `exportJSON()` : TÃ©lÃ©charge le JSON manuellement
- `validateForm()` : VÃ©rifie que tous les champs sont remplis

**Appels GitHub API** :
```javascript
// 1. GET pour rÃ©cupÃ©rer le SHA actuel
GET https://api.github.com/repos/{owner}/{repo}/contents/config/timeline.json

// 2. PUT pour mettre Ã  jour le fichier
PUT https://api.github.com/repos/{owner}/{repo}/contents/config/timeline.json
Body: {
  "message": "Update timeline dates",
  "content": base64(JSON.stringify(timelineData)),
  "sha": currentSHA,
  "branch": "master"
}
```

### Modification de `project_timeline.html`

**Ajout d'attributs data** :
```html
<!-- Sprint 1 -->
<div class="sprint-date" data-sprint-id="1">Semaine du 3 novembre</div>

<!-- Sprint 2 -->
<div class="sprint-date" data-sprint-id="2">Semaine du 10 novembre</div>

<!-- ... (rÃ©pÃ©tÃ© pour les 8 sprints) -->
```

**Script d'injection** (ajoutÃ© avant `</body>`) :
```javascript
<script>
  (async function loadTimelineDates() {
    try {
      const response = await fetch('../../config/timeline.json');
      if (!response.ok) {
        console.warn('timeline.json non trouvÃ©, dates par dÃ©faut conservÃ©es');
        return;
      }
      
      const data = await response.json();
      
      data.sprints.forEach(sprint => {
        const el = document.querySelector(`[data-sprint-id="${sprint.id}"]`);
        if (el) {
          el.textContent = `Semaine du ${sprint.date}`;
        }
      });
    } catch (e) {
      console.warn('Erreur chargement timeline.json:', e);
    }
  })();
</script>
```

---

## ğŸ¨ Design et UX

### Page Admin

**Palette de couleurs** : CohÃ©rente avec les autres pages admin
- Primaire : `#007bff`
- SuccÃ¨s : `#28a745`
- Danger : `#dc3545`
- Fond : `#f0f8ff`

**Layout** :
- Header avec titre + icÃ´ne calendrier + bouton retour
- Configuration GitHub (repliable, identique aux autres pages admin)
- Formulaire en grille 2 colonnes (responsive : 1 colonne sur mobile)
- Boutons d'action en bas : "Sauvegarder" (bleu) et "Exporter JSON" (gris)

**Validation visuelle** :
- Champs vides : bordure rouge
- Champs valides : bordure verte
- Message d'erreur sous chaque champ invalide

### Timeline Page

**Pas de changement visuel** : Les dates sont injectÃ©es dynamiquement sans modifier le design existant.

**Indicateur de chargement** (optionnel) : Petit spinner pendant le fetch du JSON.

---

## ğŸ“‹ Plan d'ImplÃ©mentation

### Phase 1 : CrÃ©ation du Fichier JSON (10 min)

1. âœ… CrÃ©er `config/timeline.json`
2. âœ… Remplir avec les 8 dates actuelles de `project_timeline.html`
3. âœ… Valider la structure JSON

### Phase 2 : Modification de `project_timeline.html` (20 min)

1. âœ… Ajouter `data-sprint-id` sur les 8 `<div class="sprint-date">`
2. âœ… CrÃ©er le script d'injection dynamique
3. âœ… Tester le chargement et l'injection
4. âœ… VÃ©rifier le fallback si JSON absent

### Phase 3 : CrÃ©ation de `admin-timeline.html` (90 min)

1. âœ… Structure HTML de base (header, tabs, formulaire)
2. âœ… Styles CSS (cohÃ©rents avec les autres pages admin)
3. âœ… Scripts de protection (auth-guard, admin-guard)
4. âœ… Fonction `loadTimeline()` pour charger les donnÃ©es
5. âœ… Fonction `saveToGitHub()` (pattern de admin-announcements)
6. âœ… Fonction `exportJSON()` pour export manuel
7. âœ… Validation du formulaire
8. âœ… Tests de sauvegarde et rechargement

### Phase 4 : IntÃ©gration dans le Menu (10 min)

1. âœ… Ajouter un lien "Gestion du Calendrier" dans le dropdown admin de `menu.html`
2. âœ… IcÃ´ne : `<i class="fas fa-calendar-alt"></i>`
3. âœ… Href : `../admin/admin-timeline.html`

### Phase 5 : Tests et Validation (30 min)

1. âœ… Tester la page timeline avec JSON valide
2. âœ… Tester la page timeline sans JSON (fallback)
3. âœ… Tester l'admin : chargement, modification, sauvegarde GitHub
4. âœ… Tester l'admin : export JSON manuel
5. âœ… Tester avec diffÃ©rents formats de dates (plages, dates simples)
6. âœ… VÃ©rifier les permissions admin
7. âœ… Tests responsive (mobile/tablet/desktop)

**DurÃ©e totale estimÃ©e** : 2h30

---

## âš ï¸ Risques et Mitigation

### Risques IdentifiÃ©s

| Risque | ProbabilitÃ© | Impact | Mitigation |
|--------|-------------|--------|------------|
| JSON corrompu | Moyenne | Moyen | Fallback sur dates en dur + validation cÃ´tÃ© admin |
| GitHub API rate limit | Faible | Moyen | Export manuel JSON disponible |
| Format de date incohÃ©rent | Moyenne | Faible | Format libre acceptÃ©, pas de validation stricte |
| Chargement lent du JSON | Faible | Faible | Dates en dur visibles immÃ©diatement, remplacement rapide |

### StratÃ©gies de Mitigation

1. **Fallback robuste** : Si `timeline.json` Ã©choue, les dates en dur restent affichÃ©es
2. **Validation cÃ´tÃ© admin** : EmpÃªche la sauvegarde de donnÃ©es invalides
3. **Export manuel** : Alternative si GitHub API indisponible
4. **Format flexible** : Accepte n'importe quel texte pour les dates (pas de contrainte ISO)

---

## âœ… CritÃ¨res d'Acceptation

### FonctionnalitÃ© Principale

- [ ] Les 8 dates de la timeline sont chargÃ©es depuis `timeline.json`
- [ ] Si le JSON n'existe pas, les dates en dur sont conservÃ©es
- [ ] Les dates s'affichent correctement sur tous les navigateurs (Chrome, Firefox, Safari, Edge)

### Page Admin

- [ ] Accessible uniquement aux utilisateurs avec rÃ´le `admin`
- [ ] Les 8 champs du formulaire se remplissent automatiquement avec les dates actuelles
- [ ] Les modifications sont sauvegardÃ©es via GitHub API
- [ ] Un bouton "Exporter JSON" permet le tÃ©lÃ©chargement manuel
- [ ] Les champs vides sont dÃ©tectÃ©s et empÃªchent la sauvegarde
- [ ] Un message de confirmation s'affiche aprÃ¨s sauvegarde rÃ©ussie

### IntÃ©gration

- [ ] Un lien "Gestion du Calendrier" est ajoutÃ© au menu admin
- [ ] Le lien redirige vers `pages/admin/admin-timeline.html`
- [ ] La navigation entre pages fonctionne correctement

### Non-RÃ©gression

- [ ] La page timeline reste visuellement identique
- [ ] Aucun impact sur les autres pages du projet
- [ ] Les performances de chargement sont acceptables (< 200ms)

---

## ğŸ“Š MÃ©triques de SuccÃ¨s

### Quantitatives

- âœ… 100% des dates chargÃ©es depuis le JSON
- âœ… Temps de chargement du JSON < 100ms
- âœ… 0 erreur JavaScript en console
- âœ… Sauvegarde GitHub rÃ©ussie en < 2 secondes

### Qualitatives

- âœ… Interface admin intuitive et facile Ã  utiliser
- âœ… Aucune modification visible du design de la timeline
- âœ… Processus de modification des dates simplifiÃ© (plus besoin d'Ã©diter le HTML)

---

## ğŸ”„ Ã‰volutions Futures (Post-MVP)

### Phase 2 (Optionnel)

1. **Multi-groupes** : CrÃ©er plusieurs fichiers JSON (timeline_groupe1.json, timeline_groupe2.json)
2. **SÃ©lecteur de groupe** : Permettre Ã  l'Ã©tudiant de choisir son groupe au login
3. **Import CSV** : Importer les dates depuis un fichier CSV
4. **Historique** : Sauvegarder les anciennes configurations de dates
5. **Validation de format** : Ajouter un calendrier picker pour les dates

### Phase 3 (AvancÃ©)

1. **Notifications** : Alerter les Ã©tudiants X jours avant chaque sprint
2. **IntÃ©gration calendrier** : Exporter vers iCal/Google Calendar
3. **Gestion des tÃ¢ches** : Rendre les tÃ¢ches de chaque sprint configurables Ã©galement

---

## ğŸ’¡ Recommandations

### Bonnes Pratiques

1. **CohÃ©rence** : Utiliser le mÃªme pattern GitHub API que `admin-announcements.html`
2. **Fallback** : Toujours garder des dates en dur comme fallback
3. **Validation** : Valider les donnÃ©es cÃ´tÃ© client ET cÃ´tÃ© serveur (GitHub)
4. **Format libre** : Ne pas imposer de format de date strict (permet "8 dÃ©cembre au 23 janvier")
5. **Tests** : Tester avec et sans GitHub API configurÃ©

### Questions Ouvertes

1. **Quelle est la frÃ©quence de changement des dates ?** â†’ DÃ©termine si le cache est nÃ©cessaire
2. **Faut-il historiser les modifications ?** â†’ Permet de revenir en arriÃ¨re
3. **Y a-t-il besoin d'un systÃ¨me de multi-groupes dÃ¨s le MVP ?** â†’ Simplifierait la gestion

---

## ğŸ“ Contacts et Support

- **Responsable du projet** : Ã€ dÃ©finir
- **Questions techniques** : GitHub Issues
- **Documentation** : Voir `docs/markdown/README.md`

---

## ğŸ“… Historique des Versions

| Version | Date | Auteur | Modifications |
|---------|------|--------|---------------|
| 1.0 | 10 nov 2025 | GitHub Copilot | CrÃ©ation initiale du PRD |

---

## âœï¸ Signatures d'Approbation

| RÃ´le | Nom | Date | Signature |
|------|-----|------|-----------|
| Chef de projet | | | |
| DÃ©veloppeur principal | | | |
| Testeur | | | |

---

**Fin du Document**
